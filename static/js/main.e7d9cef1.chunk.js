(this["webpackJsonpmovie-tracker"]=this["webpackJsonpmovie-tracker"]||[]).push([[0],{33:function(e,t,a){e.exports=a(52)},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),c=a(6),i=a(4),o=a(10),u=a(29),l=a(30),m=Object(o.combineReducers)({hasError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HAS_ERRORED":return t.payload;default:return e}},isLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_LOADING":return t.payload;default:return e}},movies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MOVIES_SUCCESS":return t.payload;default:return e}},ratings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_RATINGS_SUCCESS":case"POST_RATING_SUCCESS":case"DELETE_RATING_SUCCESS":return t.payload;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return t.payload;case"LOGOUT_USER":return null;default:return e}}}),p=a(11),f=a(12),d=a(13),v=a(14),h=a(15),g=a(1),E=a.n(g),b=a(3),N=function(e){return{type:"HAS_ERRORED",payload:e}},w=function(e){return{type:"IS_LOADING",payload:e}},y=function(e){return{type:"GET_MOVIES_SUCCESS",payload:e}},O=function(e){return{type:"GET_RATINGS_SUCCESS",payload:e}},k="https://rancid-tomatillos.herokuapp.com/api/v1",j=function(){var e=Object(b.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(k+"/movies");case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Error fetching movies.");case 5:return e.next=7,t.json();case 7:return a=e.sent,e.abrupt("return",a.movies);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=a(31),x=a(21),R=function(e,t){return e.movies.find((function(e){return e.id===parseInt(t)}))||{}},C=function(e){return Object(x.a)(e).sort((function(e,t){return t.release_date-e.release_date}))},_=(a(43),function(){return r.a.createElement("div",{className:"fa-3x","aria-busy":"true","aria-label":"loading","aria-live":"polite",role:"status"},r.a.createElement("i",{className:"fas fa-spinner fa-spin"}))}),I=(a(44),a(45),function(){var e=Object(b.a)(E.a.mark((function e(t,a,n){var r,s,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={movie_id:t,rating:n},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},e.next=4,fetch("".concat(k+"/users","/").concat(a).concat("/ratings"),s);case 4:if((c=e.sent).ok){e.next=7;break}throw Error("Invalid movie or rating.");case 7:return e.next=9,c.json();case 9:return i=e.sent,e.abrupt("return",i.rating.rating);case 11:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),D=function(){var e=Object(b.a)(E.a.mark((function e(t){var a,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(k+"/users","/").concat(t).concat("/ratings"));case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Error fetching ratings.");case 5:return e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n.ratings);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(b.a)(E.a.mark((function e(t,a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(k+"/users","/").concat(t).concat("/ratings","/").concat(a),{method:"DELETE",headers:{"Content-Type":"application/json"}});case 2:if(e.sent.ok){e.next=5;break}throw new Error("Error deleting rating.");case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),L=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).toggleDropdown=function(e){n.setState({dropdown:!n.state.dropdown})},n.hoverHandler=function(e){var t=e.target.parentElement.getElementsByClassName("rating-selector"),a=e.target.dataset.value;Array.from(t).forEach((function(e){e.style.color=a>=e.dataset.value?"#ffdd00":"#e4e4e4"}))},n.updateRating=function(){var e=Object(b.a)(E.a.mark((function e(t){var a,r,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=parseInt(t.target.dataset.value)+1,r=n.props.rating(n.props.movieID),s=null,r&&(s=n.props.getRatingID(n.props.movieID)),e.next=6,n.props.postRating(n.props.movieID,n.props.userID,a,s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={rating:null,dropdown:!1,movieID:e.movieID},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.rating(this.props.movieID);this.setState({rating:e})}},{key:"componentDidUpdate",value:function(){if(this.state.rating!=this.props.rating(this.props.movieID)){var e=this.props.rating(this.props.movieID);this.setState({rating:e})}}},{key:"render",value:function(){var e=this,t=this.state.dropdown?"":"hidden",a="ratings-dropdown ".concat(t),n=this.state.rating?"yellow":"";return r.a.createElement("div",{className:"user-rating",onClick:function(){return e.toggleDropdown()}},r.a.createElement("p",{className:"rating"},this.state.rating||r.a.createElement("span",{className:"rate-this"},"Rate\xa0This")),r.a.createElement("i",{className:"fas fa-thumbs-up ".concat(n)}),r.a.createElement("div",{className:a,onMouseOver:this.hoverHandler},r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"0",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"1",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"2",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"3",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"4",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"5",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"6",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"7",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"8",onClick:this.updateRating}),r.a.createElement("i",{className:"fas fa-thumbs-up rating-selector","data-value":"9",onClick:this.updateRating}),r.a.createElement("i",{className:"far fa-times-circle","data-value":this.state.rating-1})))}}]),a}(r.a.Component),U=Object(i.b)((function(e){return{rating:function(t){return function(e,t){var a=Object(S.a)({},t.find((function(t){return t.movie_id===e})));return a.rating?a.rating:null}(t,e.ratings)},userID:e.user.id,getRatingID:function(t){return function(e,t){var a=Object(x.a)(t).find((function(t){return t.movie_id===e})).id;return console.log(a),a}(t,e.ratings)}}}),(function(e){return{postRating:function(t,a,n,r){return e(function(e,t,a,n){return function(){var r=Object(b.a)(E.a.mark((function r(s){var c;return E.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,s(w(!0)),!n){r.next=5;break}return r.next=5,T(t,n);case 5:return r.next=7,I(e,t,a);case 7:return r.next=9,D(t);case 9:return c=r.sent,r.next=12,s({type:"POST_RATING_SUCCESS",payload:c});case 12:s(w(!1)),r.next=19;break;case 15:r.prev=15,r.t0=r.catch(0),s(w(!1)),s(N(r.t0.message));case 19:case"end":return r.stop()}}),r,null,[[0,15]])})));return function(e){return r.apply(this,arguments)}}()}(t,a,n,r))}}}))(L),G=Object(i.b)((function(e){return{user:e.user}}))((function(e){var t=e.avgRating,a=(e.description,e.id),n=e.image,s=(e.imageBackdrop,e.release,e.title),i=e.user;return r.a.createElement("article",{className:"movie-card"},r.a.createElement(c.b,{to:"/movies/"+a},r.a.createElement("img",{src:n,alt:"Poster for ".concat(s),className:"movie-card-image"})),r.a.createElement("div",{className:"title-wrapper"},r.a.createElement(c.b,{to:"/movies/"+a},r.a.createElement("p",{className:"movie-card-title"},s)),r.a.createElement("div",{className:"movie-card-rating"},r.a.createElement("div",{className:"avg-rating"},r.a.createElement("p",null,t.toFixed()),r.a.createElement("i",{className:"fas fa-star"})),i&&r.a.createElement(U,{movieID:a}))))})),M=Object(i.b)((function(e){return{isLoading:e.isLoading,topMovies:(t=e.movies,Object(x.a)(t).sort((function(e,t){return t.average_rating-e.average_rating}))),latestMovies:C(e.movies)};var t}))((function(e){var t=e.isLoading,a=e.topMovies,n=e.latestMovies,s=function(e){return e.map((function(e){return r.a.createElement(G,{avgRating:e.average_rating,description:e.overview,id:e.id,image:e.poster_path,imageBackdrop:e.backdrop_path,key:e.id,release:e.release_date,title:e.title})}))};return r.a.createElement("section",{className:"container-wrapper"},r.a.createElement("h2",{className:"container-title"},"Latest"),t&&r.a.createElement(_,null),r.a.createElement("section",{className:"card-container"},s(n)),r.a.createElement("h2",{className:"container-title"},"Top Rated"),r.a.createElement("section",{className:"card-container"},s(a)))})),A=(a(47),Object(i.b)((function(e){return{user:e.user}}))((function(e){var t=e.image,a=e.releaseDate,n=e.title,s=e.rating,c=e.overview,i=e.user,o=e.id;return r.a.createElement("section",{className:"movie-details-card-wrapper"},r.a.createElement("img",{src:t,alt:n}),r.a.createElement("article",null,r.a.createElement("p",null,"Release Date: ",a),r.a.createElement("h2",null,n),r.a.createElement("p",null,"Rating: ",s),i&&r.a.createElement(U,{movieID:o}),r.a.createElement("p",null,c)))}))),F=Object(i.b)((function(e,t){return{movie:R(e,t.match.params.id)}}))((function(e){e.match;var t=e.movie;return r.a.createElement("div",null,r.a.createElement(A,{image:t.poster_path,releaseDate:t.release_date,title:t.title,rating:t.average_rating?t.average_rating.toFixed():null,overview:t.overview,id:t.id}))})),P=a(20),B=function(){var e=Object(b.a)(E.a.mark((function e(t){var a,n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,fetch(k+"/login",a);case 3:if((n=e.sent).ok){e.next=6;break}throw Error("Please use a valid username and password.");case 6:return e.next=8,n.json();case 8:return r=e.sent,e.abrupt("return",r.user);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=(a(48),function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.setState(Object(P.a)({},e.target.name,e.target.value))},n.onSubmit=function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.props.authorizeUser(n.state);case 3:a=e.sent,n.props.requestRatings(a.id),n.setState({email:"",password:""});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.renderRedirect=function(){if(n.props.user&&n.props.ratings.length)return r.a.createElement(h.a,{to:"/"})},n.state={email:"",password:""},n}return Object(f.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password,s=a&&n;return r.a.createElement(r.a.Fragment,null,this.renderRedirect(),r.a.createElement("form",{className:"login-form",onSubmit:this.onSubmit},r.a.createElement("h2",{className:"title"},"Log in"),r.a.createElement(c.b,{to:"/"},r.a.createElement("button",{"aria-label":"Close login form",className:"close-button","data-testid":"close-button",onClick:function(){return e.props.hasErrored(null)},type:"button"},r.a.createElement("i",{className:"far fa-times-circle"}))),r.a.createElement("label",{htmlFor:"email"},"Email",r.a.createElement("input",{id:"email",name:"email",onChange:this.onChange,type:"email",value:a})),r.a.createElement("label",{htmlFor:"password"},"Password",r.a.createElement("input",{id:"password",name:"password",onChange:this.onChange,type:"password",value:n})),this.props.isLoading&&r.a.createElement(_,null),this.props.hasError&&r.a.createElement("p",{className:"login-error"},this.props.hasError),r.a.createElement("button",{className:"submit-button",disabled:!s,type:"submit"},"Log in")))}}]),a}(n.Component)),q=Object(i.b)((function(e){return{hasError:e.hasError,isLoading:e.isLoading,user:e.user,ratings:e.ratings}}),(function(e){return{authorizeUser:function(t){return e(function(e){return function(){var t=Object(b.a)(E.a.mark((function t(a){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(w(!0)),t.next=4,B(e);case 4:return n=t.sent,t.next=7,a({type:"LOGIN_USER",payload:n});case 7:return a(w(!1)),a(N(null)),t.abrupt("return",n);case 12:t.prev=12,t.t0=t.catch(0),a(w(!1)),a(N(t.t0.message));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(t))},hasErrored:function(t){return e(N(t))},requestRatings:function(t){return e(function(e){return function(){var t=Object(b.a)(E.a.mark((function t(a){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(w(!0)),t.next=4,D(e);case 4:return n=t.sent,t.next=7,a(O(n));case 7:a(w(!1)),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),a(w(!1)),a(N(t.t0.message));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))(H),J=(a(49),function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={redirect:!1},e.onLogout=function(){e.props.logoutUser(),e.setState({redirect:!0})},e.renderRedirect=function(){if(e.state.redirect)return r.a.createElement(h.a,{to:"/"})},e}return Object(f.a)(a,[{key:"render",value:function(){var e=this.props.user;return r.a.createElement(r.a.Fragment,null,this.renderRedirect(),r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"title"},r.a.createElement("i",{className:"fas fa-film"}),"Movie Tracker"),r.a.createElement("div",{className:"login-container"},!e&&r.a.createElement(c.b,{to:"/login",className:"header-link"},"Log in"),e&&r.a.createElement("div",{className:"user-container"},r.a.createElement("p",{className:"user-welcome"},"Hi, ",e.name),r.a.createElement("a",{className:"header-link",onClick:this.onLogout},"Log out")))))}}]),a}(n.Component)),V=Object(i.b)((function(e){return{user:e.user}}),(function(e){return{logoutUser:function(){return e({type:"LOGOUT_USER"})}}}))(J),z=function(e){return r.a.createElement("nav",{className:"nav"},r.a.createElement("section",{className:"nav-section"},r.a.createElement("h4",{className:"nav-category"},"Browse"),r.a.createElement(c.c,{to:"/",className:"nav-link"},r.a.createElement("i",{className:"fas fa-border-all"}),"View all"),r.a.createElement(c.c,{to:"/",className:"nav-link"},r.a.createElement("i",{className:"fas fa-fire-alt"}),"Top rated")),r.a.createElement("section",{className:"nav-section"},r.a.createElement("h4",{className:"nav-category"},"Filter"),r.a.createElement("p",{className:"nav-link"},r.a.createElement("i",{className:"fas fa-plus"}),"Rating"),r.a.createElement("p",{className:"nav-link"},r.a.createElement("i",{className:"fas fa-plus"}),"Release date")))},W=(a(50),function(){return r.a.createElement("p",{className:"page-not-found"},"Sorry, we can't seem to find the page you were looking for.")}),K=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(f.a)(a,[{key:"componentDidMount",value:function(){this.props.requestMovies()}},{key:"render",value:function(){return r.a.createElement("div",{className:"layout"},r.a.createElement(V,null),r.a.createElement(z,null),r.a.createElement("main",{className:"main"},r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/movies/:id",component:F}),r.a.createElement(h.b,{path:"/login",component:q}),r.a.createElement(h.b,{exact:!0,path:"/",component:M}),r.a.createElement(h.b,{component:W}))))}}]),a}(n.Component),Q=Object(i.b)(null,(function(e){return{requestMovies:function(){return e(function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(w(!0)),e.next=4,j();case 4:return a=e.sent,e.next=7,t(y(a));case 7:t(w(!1)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),t(w(!1)),t(N(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())}}}))(K),X=(a(51),Object(o.createStore)(m,Object(u.composeWithDevTools)(Object(o.applyMiddleware)(l.a))));Object(s.render)(r.a.createElement(i.a,{store:X},r.a.createElement(c.a,null,r.a.createElement(Q,null))),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.e7d9cef1.chunk.js.map